<!DOCTYPE html>
<!-- For more information about the tech and the developers, GET /humans.txt -->
<html lang="en">
  <head>
    <meta charset="utf-8" />

    <!-- iOS Homescreen specials -->
  	<meta name="apple-mobile-web-app-title" content="Chalmers.it">
  	<meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="default" />

  	<!-- Viewport setting -->
  	<meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1, maximum-scale=1, user-scalable=no" />

    <title><%= yield(:title) + ' | ' if content_for?(:title) %><%= Configurable.site_title %></title>

    <link href="//fonts.googleapis.com/css?family=Ubuntu:300,400,500,700,400italic" rel="stylesheet" type="text/css">
    <% I18n.available_locales.each do |locale| %>
      <%= auto_discovery_link_tag(:rss, feed_url(locale: locale), title: t('in_locale', {name: Post.model_name.human(count: 2), lang: t(locale)})) %>
    <% end %>
    <%= stylesheet_link_tag    "application" %>
    <%= javascript_include_tag "vendor/modernizr" %>
    <%= csrf_meta_tags %>
  </head>

  <body class="<%= body_classes %>">
    <header role="banner">
      <div class="top-bar">
        <div class="inner-bar" id="site-menu">
          <div class="wrapper group">
              <h1>
                <%= link_to root_path(locale: locale_or_nil), class: 'logo' do %>
                    <%= t 'it' %><br />
                    <small><%= t 'chs' %></small>
                <% end %>
              </h1>
            <nav role="navigation" class="main-nav">
              <ul id="menu-huvudnavigation">
                <% cache ['main-menu', I18n.locale] do %>
                  <% Menu.where(name: 'main').last.links.each do |link| %>
                    <%= header_link_to_current t(link.title), link.path %>
                  <% end %>
                <% end %>
              </ul>
            </nav>
          </div>
        </div>

        <div class="header-toolbar wrapper">
          <a id="main-nav-toggle" class="show-for-small">â‰¡</a>
          <ul class="header-controls horizontal-list">
            <% if signed_in? %>
              <li class="user-details icon-align">
                <strong><%= current_user.display_name %></strong>
              </li>
              <% cache ['user-menu', I18n.locale] do %>
                <li class="dropdown icon-align">
                  <span id="tools-menu-trigger" class="dropdown-trigger"><%= fa_icon 'cog', text: t('.tools') %></span>
                  <ul class="dropdown-sub">
                    <% if policy(Post).create? %>
                      <li><%= link_to t('.new_news_post'), new_post_path %></li>
                    <% end %>
                    <li><%= link_to t('.edit_profile'), edit_user_path %></li>
                    <% if current_user.admin? %>
                      <li><%= link_to t('.admin'), '#admin_path', target: '_blank' %></li>
                      <li><%= link_to t('.edit_frontpage'), edit_frontpage_path %></li>
                    <% end %>
                    <li><%= link_to t('logout'), signout_path %></li>
                  </ul>
                </li>
              <% end %>
            <% else %>
              <li><%= link_to t('login'), "/auth/account", class: 'button tiny', id: 'login-btn' %></li>
            <% end %>
            <li id="header-search">
              <%= form_tag(search_path, :method => :get) do %>
                <%= search_field_tag :search, params[:search] %>
                <i class="fa fa-search"></i>
              <% end %>
            </li>
            <li class="flags dropdown">
              <span class="dropdown-trigger"><%= image_tag("flags/#{I18n.locale}.svg") %></span>
              <ul class="dropdown-sub">
                <% I18n.available_locales.each do |item| %>
                  <% unless I18n.locale == item %>
                    <li><%= link_to image_tag("flags/#{item}.svg"), locale: item == I18n.default_locale ? nil : item %></li>
                  <% end %>
                <% end %>
              </ul>
            </li>
          </ul>
        </div>
      </div>
    </header>
    <section role="main" class="wrapper">
      <%= render 'layouts/messages' %>
